(function e(t,n,r){function a(s,o){if(!n[s]){if(!t[s]){var c=typeof require=="function"&&require;if(!o&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return a(n?n:e)},f,f.exports,e,t,n,r)}return n[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<r.length;s++)a(r[s]);return a})({1:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./index");var a=typeof window!=="undefined"?window["Rx"]:typeof t!=="undefined"?t["Rx"]:null;var i=typeof window!=="undefined"?window["Rx"]:typeof t!=="undefined"?t["Rx"]:null;var s=e("./subjects");var o=e("./addEffects");var c=e("./addReducers");var u=function(){function e(e){this.isOpen=true;this.state$=new a.BehaviorSubject(e.state);this.subs=[];this.userExtra$=new a.BehaviorSubject({});this.newExtras$=new i.Subject;this.subs.push(this.newExtras$.scan(s.assignFn,{}).subscribe(this.userExtra$));this.storeReducers=new a.BehaviorSubject([]);this.newReducer$=new i.Subject;this.subs.push(this.newReducer$.scan(s.concatFn,[]).subscribe(this.storeReducers));this.mappedReducers=new a.BehaviorSubject([]);this.newMappedReducer$=new i.Subject;this.subs.push(this.newMappedReducer$.scan(s.concatFn,[]).subscribe(this.mappedReducers));this.storeResponses=new a.BehaviorSubject([]);this.newResponses=new i.Subject;this.subs.push(this.newResponses.scan(s.concatFn,[]).subscribe(this.storeResponses));this.action$=new i.Subject;this.actionsWithState$=this.action$.withLatestFrom(this.state$,function(e,t){return{action:e,state:t}});this.actionsWithResultingStateUpdate$=this.actionsWithState$;this.postDispatchFns=[].concat(e.postDispatch).filter(Boolean)}e.prototype.register=function(e){var t=e.state,n=e.reducers,r=e.effects,a=e.responses,i=e.extras;if(t){this._registerOnStateTree(t)}if(n){this._addReducers(n)}if(i){this._addExtras(i)}if(r){this._addEffects(r)}if(a){this._addResponses(a)}return this};e.prototype._registerOnStateTree=function(e){for(var t in e){this.dispatcher({type:"@@NS-INIT("+t+")",payload:{path:[t],value:e[t]}})}};e.prototype._addExtras=function(e){var t=this;r.alwaysArray(e).forEach(function(e){t.newExtras$.next(e)})};e.prototype._addResponses=function(e){var t=this;r.alwaysArray(e).forEach(function(e){Object.keys(e).forEach(function(n){var r=e[n];t.newResponses.next({name:n,path:[].concat(r.path).filter(Boolean),targetName:r.action})})})};e.prototype.dispatcher=function(e){var t=this;if(!this.isOpen){return}if(Array.isArray(e)){e.forEach(function(e){t.action$.next(e)})}else{this.action$.next(e)}if(this.postDispatchFns.length){this.postDispatchFns.forEach(function(t){return t(e)})}};e.prototype._addMiddleware=function(e){var t=this;r.alwaysArray(e).forEach(function(e){e.call(null,t)})};e.prototype._addEffects=function(e){var t=this;var n={state$:this.state$,action$:this.action$,actionsWithState$:this.actionsWithState$,actionsWithResultingStateUpdate$:this.actionsWithState$};o.gatherEffects(e,this.actionsWithState$,n,this.userExtra$).forEach(function(e){if(e.type===c.InputTypes.Effect){t.subs.push(e.payload.subscribe(t.dispatcher.bind(t)))}})};e.prototype._addReducers=function(e){var t=this;c.gatherReducers(e).forEach(function(e){if(e.type===c.InputTypes.Reducer){t.newReducer$.next(e.payload)}if(e.type===c.InputTypes.MappedReducer){t.newMappedReducer$.next(e.payload)}if(e.type===c.InputTypes.State){t._registerOnStateTree(e.payload)}})};e.prototype.addReducers=function(e){this._addReducers(e);return this};e.prototype.dispatch=function(e){this.dispatcher(e);return this};e.prototype.getState=function(e){var t=r.alwaysArray(e);return this.state$.getValue().getIn(t,r.getMap({}))};e.prototype.toJS=function(e){var t=r.alwaysArray(e);return this.state$.getValue().getIn(t,r.getMap({})).toJS()};e.prototype.toJSON=function(e){var t=r.alwaysArray(e);return this.state$.getValue().getIn(t,r.getMap({})).toJSON()};e.prototype.addMiddleware=function(e){this._addMiddleware(e);return this};e.prototype.changes=function(e){var t=r.alwaysArray(e);return this.state$.map(function(e){return e.getIn(t)}).distinctUntilChanged()};e.prototype.once=function(e){var t=r.alwaysArray(e);return this.actionsWithState$.filter(function(e){return t.indexOf(e.action.type)>-1}).take(1)};e.prototype.addExtras=function(e){this._addExtras(e);return this};e.prototype.addEffects=function(e){this._addEffects(e);return this};e.prototype.close=function(){if(this.isOpen){this.subs.forEach(function(e){return e.unsubscribe()});this.isOpen=false}return this};e.prototype.ofType=function(e){var t=r.alwaysArray(e);return this.actionsWithState$.filter(function(e){var n=e.action;return t.indexOf(n.type)>-1})};return e}();n.StaunchStore=u}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./addEffects":3,"./addReducers":4,"./index":5,"./subjects":7}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./index");function a(e,t,n,a){return t.do(function(e){if(!r.isPlainObject(e)){return console.error("Please provide an object with at least a `type` property")}if(typeof e.type!=="string"){return console.error("Action was missing a `type` property",e)}}).withLatestFrom(n,a,function(e,t,n){var r=n.filter(function(t){return t.name===e.type});return{action:e,reducers:r.concat(t)}}).scan(function(e,t){var n=t.action,a=t.reducers;var i=n.type||(typeof n==="string"?n:"");if(i.indexOf("@@NS-INIT")===0){return e.setIn(n.payload.path,r.alwaysMap((n.payload||{}).value))}else{return a.reduce(function(e,t){var a=t.type===r.ReducerTypes.MappedReducer?n.payload:n;return e.updateIn(t.path,function(n){return t.fns.reduce(function(t,n){return n.call(null,t,a,e)},n)})},e)}},e)}n.actionStream=a},{"./index":5}],3:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a))e[a]=t[a]}return e};Object.defineProperty(n,"__esModule",{value:true});var a=e("./index");var i=e("./addReducers");function s(e,t,n,s){var o={ofType:function(e){return t.filter(function(t){return t.action.type===e})}};var c=Object.assign({},n,s.getValue());return a.alwaysArray(e).reduce(function(e,n){if(typeof n!=="function"){console.error("Effects must be functions, you provided",n)}var a=function(){if(n.triggers&&Array.isArray(n.triggers)){return t.filter(function(e){return~n.triggers.indexOf(e.action.type)})}if(n.trigger&&typeof n.trigger==="string"){return t.filter(function(e){return n.trigger===e.action.type})}return o}();var s=n.call(null,a,c);return e.concat({type:i.InputTypes.Effect,payload:s.map(function(e){return r({},e,{via:"[effect]",name:n.name||""})})})},[])}n.gatherEffects=s},{"./addReducers":4,"./index":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./index");var a;(function(e){e[e["Reducer"]="Reducer"]="Reducer";e[e["MappedReducer"]="MappedReducers"]="MappedReducer";e[e["Effect"]="Effect"]="Effect";e[e["State"]="State"]="State"})(a=n.InputTypes||(n.InputTypes={}));function i(e){return t(e,[]);function t(e,n){return r.alwaysArray(e).reduce(function(e,i){if(typeof i==="function"){return e.concat({type:a.Reducer,payload:{path:[],fns:[i]}})}if(r.isPlainObject(i)){if(i.state){var s,o=void 0,c=void 0;if(i.reducers){s=Object.keys(i.state).reduce(function(e,n){return e.concat(t({path:n,fns:i.reducers},[]))},[])}if(i.effects){c=i.effects}o=i.state;return e.concat(s,{type:a.Effect,payload:c},{type:a.State,payload:o})}if(i.path&&i.reducers){var u=Object.keys(i.reducers).reduce(function(e,t){var n=i.reducers[t];return e.concat({type:a.MappedReducer,payload:{path:[].concat(i.path),fns:[n],name:t,type:r.ReducerTypes.MappedReducer}})},[]);return e.concat(u)}if(i.path&&i.fns){return e.concat({type:a.Reducer,payload:{path:[].concat(i.path).filter(Boolean),fns:[].concat(i.fns).filter(Boolean)}},n)}else{var f=Object.keys(i).reduce(function(e,t){return e.concat({type:a.Reducer,payload:{path:[].concat(t).filter(Boolean),fns:[].concat(i[t]).filter(Boolean)}})},[]);return e.concat(f)}}return e},n)}}n.gatherReducers=i},{"./index":5}],5:[function(e,t,n){(function(t){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a))e[a]=t[a]}return e};Object.defineProperty(n,"__esModule",{value:true});var a=typeof window!=="undefined"?window["Immutable"]:typeof t!=="undefined"?t["Immutable"]:null;var i=e("./actions");var s=e("./responses");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");e("./../noop.js");var o=e("./StaunchStore");n.StaunchStore=o.StaunchStore;var c;(function(e){e[e["MappedReducer"]="MappedReducer"]="MappedReducer";e[e["GlobalReducer"]="GlobalReducer"]="GlobalReducer"})(c=n.ReducerTypes||(n.ReducerTypes={}));function u(e){if(e===void 0){e={}}var t=d(e.state);var n=new o.StaunchStore(r({},e,{state:t}));var a=[];a.push(i.actionStream(t,n.action$,n.storeReducers,n.mappedReducers).subscribe(n.state$));a.push(s.handleResponses(n.actionsWithState$,n.storeResponses).subscribe(function(e){return n.dispatcher(e)}));n.addReducers(e.reducers);n.addEffects(e.effects);n.addMiddleware(e.middleware);n.addExtras(e.extras);return n}n.createStore=u;function f(e){return[].concat(e).filter(Boolean)}n.alwaysArray=f;function p(e){return a.Map(e)}n.getMap=p;function d(e){return a.Map.isMap(e)?e:a.fromJS(e||{})}n.alwaysMap=d;function h(e){var t="[object Object]";return Object.prototype.toString.call(e)===t}n.isPlainObject=h;n.default=u;if(typeof window!=="undefined"&&typeof window.staunch==="undefined"){window.staunch={createStore:u}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./../noop.js":8,"./StaunchStore":1,"./actions":2,"./responses":6}],6:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=typeof window!=="undefined"?window["Rx"]:typeof t!=="undefined"?t["Rx"]:null;var a=e("./index");function i(e,t){return e.withLatestFrom(t).filter(function(e){var t=e[0],n=e[1];return n.length>0}).flatMap(function(e){var t=e[0],n=t.action,i=t.state;var s=e[1];var o=n.type;var c=s.filter(function(e){return e.name===o});var u=c.map(function(e){return{type:e.targetName,payload:i.getIn(e.path,a.getMap({})).toJS(),via:"[response to ("+o+")]"}});return r.Observable.of(u)})}n.handleResponses=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./index":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});function r(e,t){return Object.assign({},e,t)}n.assignFn=r;function a(e,t){return e.concat(t)}n.concatFn=a},{}],8:[function(e,t,n){},{}]},{},[5]);
//# sourceMappingURL=staunch.min.js.map

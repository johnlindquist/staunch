{"version":3,"sources":["node_modules/browser-pack/_prelude.js","dist/actions.js","dist/addEffects.js","dist/addReducers.js","dist/index.js","dist/responses.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","Object","defineProperty","value","index_1","actionStream","intialState","action$","storeReducers","mappedReducers","do","action","isPlainObject","console","error","type","withLatestFrom","reducers","mappedReducersThatMatchAction","filter","reducer","name","concat","scan","stateMap","_a","actionType","indexOf","setIn","payload","path","alwaysMap","reduce","outgoingValue","reducerPayload","ReducerTypes","MappedReducer","updateIn","currentValue","fns","fn","__assign","this","assign","arguments","p","prototype","hasOwnProperty","addEffects","incoming","actionsWithState$","storeExtras","userExtra$","_dispatcher","actionsApi","ofType","actionName","_addEffects","effects","extras","getValue","alwaysArray","forEach","effect","stream","triggers","Array","isArray","trigger","map","via","InputTypes","gatherReducers","_addReducers","initial","acc","Reducer","state","reducers_1","keys","stateKey","Effect","State","maps","currentFn","Boolean","outgoing","key","Rx","window","global","Immutable","actions_1","responses_1","addReducers_1","addEffects_1","BehaviorSubject","Subject","createStore","initialState","initialReducers","initialEffects","initialMiddleware","initialExtras","mergedInitialState","state$","newExtras$","subscribe","newReducer$","newMappedReducer$","storeResponses","newResponses","catch","err","Observable","throw","handleResponses","actionsWithResultingStateUpdate$","onNext","_addMiddleware","middleware","api","_addExtras","extra","_registerOnStateTree","_addResponses","responses","resp","item","targetName","register","input","addReducers","dispatch","getState","lookup","getIn","getMap","toJS","toJSON","addMiddleware","once","actions","x","take","changes","distinctUntilChanged","addExtras","Map","isMap","fromJS","objectTag","toString","default","staunch","_","flatMap","matchingResponses","response","newActions","from"],"mappings":"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","sourceRoot":"","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nfunction actionStream(intialState, action$, storeReducers, mappedReducers) {\n    return action$\n        .do(function (action) {\n        if (!index_1.isPlainObject(action)) {\n            return console.error('Please provide an object with at least a `type` property');\n        }\n        if ((typeof action.type) !== 'string') {\n            return console.error('Action was missing a `type` property', action);\n        }\n    })\n        .withLatestFrom(storeReducers, mappedReducers, function (action, reducers, mappedReducers) {\n        var mappedReducersThatMatchAction = mappedReducers\n            .filter(function (reducer) {\n            return reducer.name === action.type;\n        });\n        return {\n            action: action,\n            reducers: mappedReducersThatMatchAction.concat(reducers),\n        };\n    })\n        .scan(function (stateMap, _a) {\n        var action = _a.action, reducers = _a.reducers;\n        var actionType = action.type || (typeof action === 'string' ? action : '');\n        // is it a @@namespace ?\n        if (actionType.indexOf('@@NS-INIT') === 0) {\n            return stateMap.setIn(action.payload.path, index_1.alwaysMap((action.payload || {}).value));\n        }\n        else {\n            /**\n             * Iterate through all valid reducers\n             * This will include those registered via simple functions\n             * + those mapped to a path with a specific Action name\n             */\n            return reducers.reduce(function (outgoingValue, reducer) {\n                /**\n                 * Decide whether to pass {type: NAME, payload: VALUE}\n                 *                   or   VALUE only into the reducer\n                 *\n                 */\n                var reducerPayload = reducer.type === index_1.ReducerTypes.MappedReducer\n                    ? action.payload\n                    : action;\n                /**\n                 * Now use updateIn to call this reducers functions (there could be many)\n                 * on the value that lives at this point of the tree\n                 */\n                return outgoingValue.updateIn(reducer.path, function (currentValue) {\n                    return reducer.fns.reduce(function (value, fn) {\n                        return fn.call(null, value, reducerPayload, outgoingValue);\n                    }, currentValue);\n                });\n            }, stateMap);\n        }\n    }, intialState);\n}\nexports.actionStream = actionStream;\n//# sourceMappingURL=actions.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nfunction addEffects(incoming, actionsWithState$, storeExtras, userExtra$, _dispatcher) {\n    var actionsApi = {\n        ofType: function (actionName) {\n            return actionsWithState$.filter(function (incoming) {\n                return incoming.action.type === actionName;\n            });\n        }\n    };\n    _addEffects(incoming);\n    function _addEffects(effects) {\n        var extras = Object.assign({}, storeExtras, userExtra$.getValue());\n        index_1.alwaysArray(effects).forEach(function (effect) {\n            if (typeof effect !== 'function') {\n                console.error('Effects must be functions, you provided', effect);\n            }\n            var stream = (function () {\n                if (effect.triggers && Array.isArray(effect.triggers)) {\n                    return actionsWithState$.filter(function (incoming) {\n                        return ~effect.triggers.indexOf(incoming.action.type);\n                    });\n                }\n                if (effect.trigger && typeof effect.trigger === 'string') {\n                    return actionsWithState$.filter(function (incoming) {\n                        return effect.trigger === incoming.action.type;\n                    });\n                }\n                return actionsApi;\n            })();\n            effect.call(null, stream, extras)\n                .map(function (action) {\n                return __assign({}, action, { via: '[effect]', name: (effect.name || '') });\n            })\n                .forEach(function (action) {\n                _dispatcher(action);\n            });\n        });\n    }\n}\nexports.addEffects = addEffects;\n//# sourceMappingURL=addEffects.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\n/**\n * Add either plain functions or {path, fns} pairs\n * @param reducers\n * outputTypes:\n *  - reducer\n *  - mappedReducer\n *  - effect\n *  - state\n * @private\n */\nvar InputTypes;\n(function (InputTypes) {\n    InputTypes[InputTypes[\"Reducer\"] = 'Reducer'] = \"Reducer\";\n    InputTypes[InputTypes[\"MappedReducer\"] = 'MappedReducers'] = \"MappedReducer\";\n    InputTypes[InputTypes[\"Effect\"] = 'Effect'] = \"Effect\";\n    InputTypes[InputTypes[\"State\"] = 'State'] = \"State\";\n})(InputTypes = exports.InputTypes || (exports.InputTypes = {}));\nfunction gatherReducers(incoming) {\n    return _addReducers(incoming, []);\n    function _addReducers(reducers, initial) {\n        return index_1.alwaysArray(reducers).reduce(function (acc, reducer) {\n            if (typeof reducer === 'function') {\n                return acc.concat({\n                    type: InputTypes.Reducer,\n                    payload: {\n                        path: [],\n                        fns: [reducer]\n                    }\n                });\n            }\n            if (index_1.isPlainObject(reducer)) {\n                if (reducer.state) {\n                    var reducers_1, state = void 0, effects = void 0;\n                    if (reducer.reducers) {\n                        /**\n                         * if 'state' and 'reducers' key were found,\n                         * we bind the reducers to that top-level state key\n                         */\n                        reducers_1 = Object.keys(reducer.state).reduce(function (acc, stateKey) {\n                            return acc.concat(_addReducers({ path: stateKey, fns: reducer.reducers }, []));\n                        }, []);\n                    }\n                    if (reducer.effects) {\n                        effects = reducer.effects;\n                    }\n                    /**\n                     *\n                     */\n                    state = reducer.state;\n                    return acc.concat(reducers_1, {\n                        type: InputTypes.Effect,\n                        payload: effects\n                    }, {\n                        type: InputTypes.State,\n                        payload: state\n                    });\n                }\n                if (reducer.path && reducer.reducers) {\n                    var maps = Object.keys(reducer.reducers).reduce(function (acc, name) {\n                        var currentFn = reducer.reducers[name];\n                        return acc.concat({\n                            type: InputTypes.MappedReducer,\n                            payload: {\n                                path: [].concat(reducer.path),\n                                fns: [currentFn],\n                                name: name,\n                                type: index_1.ReducerTypes.MappedReducer\n                            }\n                        });\n                    }, []);\n                    return acc.concat(maps);\n                }\n                /**\n                 * if path/fn pairs given\n                 */\n                if (reducer.path && reducer.fns) {\n                    return acc.concat({\n                        type: InputTypes.Reducer,\n                        payload: {\n                            path: [].concat(reducer.path).filter(Boolean),\n                            fns: [].concat(reducer.fns).filter(Boolean)\n                        }\n                    }, initial);\n                }\n                else {\n                    // redux style key: fn pairs\n                    var outgoing = Object.keys(reducer).reduce(function (acc, key) {\n                        return acc.concat({\n                            type: InputTypes.Reducer,\n                            payload: {\n                                path: [].concat(key).filter(Boolean),\n                                fns: [].concat(reducer[key]).filter(Boolean)\n                            }\n                        });\n                    }, []);\n                    return acc.concat(outgoing);\n                }\n            }\n            return acc;\n        }, initial);\n    }\n}\nexports.gatherReducers = gatherReducers;\n//# sourceMappingURL=addReducers.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Rx = (typeof window !== \"undefined\" ? window['Rx'] : typeof global !== \"undefined\" ? global['Rx'] : null);\nvar Immutable = (typeof window !== \"undefined\" ? window['Immutable'] : typeof global !== \"undefined\" ? global['Immutable'] : null);\nvar actions_1 = require(\"./actions\");\nvar responses_1 = require(\"./responses\");\nvar addReducers_1 = require(\"./addReducers\");\nvar addEffects_1 = require(\"./addEffects\");\nvar BehaviorSubject = Rx.BehaviorSubject;\nvar Subject = Rx.Subject;\nvar ReducerTypes;\n(function (ReducerTypes) {\n    ReducerTypes[ReducerTypes[\"MappedReducer\"] = 'MappedReducer'] = \"MappedReducer\";\n    ReducerTypes[ReducerTypes[\"GlobalReducer\"] = 'GlobalReducer'] = \"GlobalReducer\";\n})(ReducerTypes = exports.ReducerTypes || (exports.ReducerTypes = {}));\nfunction createStore(initialState, initialReducers, initialEffects, initialMiddleware, initialExtras) {\n    var mergedInitialState = alwaysMap(initialState);\n    var state$ = new BehaviorSubject(mergedInitialState);\n    var userExtra$ = new BehaviorSubject({});\n    var newExtras$ = new Subject();\n    newExtras$.scan(function (extras, incoming) {\n        return Object.assign({}, extras, incoming);\n    }, {}).subscribe(userExtra$);\n    // reducers to act upon state\n    var storeReducers = new BehaviorSubject([]);\n    var newReducer$ = new Subject();\n    newReducer$.scan(function (acc, incoming) {\n        return acc.concat(incoming);\n    }, []).subscribe(storeReducers);\n    // Mapped reducers\n    var mappedReducers = new BehaviorSubject([]);\n    var newMappedReducer$ = new Subject();\n    newMappedReducer$.scan(function (acc, incoming) {\n        return acc.concat(incoming);\n    }, []).subscribe(mappedReducers);\n    // responses\n    var storeResponses = new BehaviorSubject([]);\n    var newResponses = new Subject();\n    newResponses.scan(function (acc, incoming) {\n        return acc.concat(incoming);\n    }, []).subscribe(storeResponses);\n    // stream of actions\n    var action$ = new Subject();\n    // stream\n    actions_1.actionStream(mergedInitialState, action$, storeReducers, mappedReducers)\n        .catch(function (err) {\n        // console.error(err);\n        return Rx.Observable.throw(err);\n    })\n        .subscribe(state$);\n    /**\n     * Create a stream that has updates + resulting state updates\n     */\n    var actionsWithState$ = action$.withLatestFrom(state$, function (action, state) {\n        return {\n            action: action,\n            state: state\n        };\n    });\n    /**\n     * Setup responses for declarative cross-domain communication\n     */\n    responses_1.handleResponses(actionsWithState$, storeResponses)\n        .subscribe(function (action) { return _dispatcher(action); });\n    /**\n     * Default extras that get passed to all 'effects'\n     */\n    var storeExtras = {\n        state$: state$,\n        action$: action$,\n        actionsWithState$: actionsWithState$,\n        actionsWithResultingStateUpdate$: actionsWithState$\n    };\n    /**\n     * Dispatch 1 or many actions\n     * @param action\n     * @returns {*}\n     * @private\n     */\n    function _dispatcher(action) {\n        if (Array.isArray(action)) {\n            return action.forEach(function (a) {\n                action$.onNext(a);\n            });\n        }\n        return action$.onNext(action);\n    }\n    function _addEffects(incoming) {\n        addEffects_1.addEffects(incoming, actionsWithState$, storeExtras, userExtra$, _dispatcher);\n    }\n    function _addMiddleware(middleware) {\n        alwaysArray(middleware).forEach(function (middleware) {\n            middleware.call(null, api);\n        });\n    }\n    function _addExtras(extras) {\n        alwaysArray(extras).forEach(function (extra) {\n            newExtras$.onNext(extra);\n        });\n    }\n    function _registerOnStateTree(state) {\n        for (var key in state) {\n            // now init with action\n            _dispatcher({\n                type: '@@NS-INIT(' + key + ')',\n                payload: {\n                    path: [key],\n                    value: state[key]\n                }\n            });\n        }\n    }\n    function _addResponses(responses) {\n        alwaysArray(responses).forEach(function (resp) {\n            Object.keys(resp).forEach(function (actionName) {\n                var item = resp[actionName];\n                newResponses.onNext({\n                    name: actionName,\n                    path: [].concat(item.path).filter(Boolean),\n                    targetName: item.action\n                });\n            });\n        });\n    }\n    function _addReducers(incoming) {\n        addReducers_1.gatherReducers(incoming)\n            .forEach(function (outgoing) {\n            if (outgoing.type === addReducers_1.InputTypes.Reducer) {\n                newReducer$.onNext(outgoing.payload);\n            }\n            if (outgoing.type === addReducers_1.InputTypes.MappedReducer) {\n                newMappedReducer$.onNext(outgoing.payload);\n            }\n            if (outgoing.type === addReducers_1.InputTypes.State) {\n                _registerOnStateTree(outgoing.payload);\n            }\n        });\n    }\n    var api = {\n        state$: state$,\n        action$: action$,\n        actionsWithState$: actionsWithState$,\n        actionsWithResultingStateUpdate$: actionsWithState$,\n        register: function (input) {\n            var state = input.state, reducers = input.reducers, effects = input.effects, responses = input.responses;\n            if (state) {\n                _registerOnStateTree(state);\n            }\n            if (reducers) {\n                _addReducers(reducers);\n            }\n            if (effects) {\n                _addEffects(effects);\n            }\n            if (responses) {\n                _addResponses(responses);\n            }\n            return api;\n        },\n        addReducers: function (reducers) {\n            _addReducers(reducers);\n            return api;\n        },\n        dispatch: function (action) {\n            _dispatcher(action);\n            return api;\n        },\n        getState: function (path) {\n            var lookup = alwaysArray(path);\n            return state$.getValue().getIn(lookup, getMap({}));\n        },\n        toJS: function (path) {\n            var lookup = alwaysArray(path);\n            return state$.getValue().getIn(lookup, getMap({})).toJS();\n        },\n        toJSON: function (path) {\n            var lookup = alwaysArray(path);\n            return state$.getValue().getIn(lookup, getMap({})).toJSON();\n        },\n        addMiddleware: function (middleware) {\n            _addMiddleware(middleware);\n            return api;\n        },\n        once: function (actions) {\n            var lookup = alwaysArray(actions);\n            return actionsWithState$.filter(function (x) {\n                return lookup.indexOf(x.action.type) > -1;\n            }).take(1);\n        },\n        changes: function (path) {\n            var lookup = alwaysArray(path);\n            return state$.map(function (x) { return x.getIn(lookup); })\n                .distinctUntilChanged();\n        },\n        addExtras: function (extras) {\n            _addExtras(extras);\n            return api;\n        }\n    };\n    // add initial ones\n    _addReducers(initialReducers);\n    _addEffects(initialEffects);\n    _addMiddleware(initialMiddleware);\n    _addExtras(initialExtras);\n    return api;\n}\nexports.createStore = createStore;\nfunction alwaysArray(input) {\n    return [].concat(input).filter(Boolean);\n}\nexports.alwaysArray = alwaysArray;\nfunction getMap(incoming) {\n    return Immutable.Map(incoming);\n}\nexports.getMap = getMap;\nfunction alwaysMap(input) {\n    return Immutable.Map.isMap(input) ? input : Immutable.fromJS(input || {});\n}\nexports.alwaysMap = alwaysMap;\nfunction isPlainObject(value) {\n    var objectTag = '[object Object]';\n    return Object.prototype.toString.call(value) === objectTag;\n}\nexports.isPlainObject = isPlainObject;\nexports.default = createStore;\nif ((typeof window !== 'undefined') && ((typeof window.staunch) === 'undefined')) {\n    window.staunch = {\n        createStore: createStore\n    };\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Rx = (typeof window !== \"undefined\" ? window['Rx'] : typeof global !== \"undefined\" ? global['Rx'] : null);\nvar index_1 = require(\"./index\");\nfunction handleResponses(actionsWithState$, storeResponses) {\n    /**\n     * Setup responses for declarative cross-domain communication\n     */\n    return actionsWithState$\n        .withLatestFrom(storeResponses)\n        .filter(function (_a) {\n        var _ = _a[0], storeResponses = _a[1];\n        return storeResponses.length > 0;\n    })\n        .flatMap(function (incoming) {\n        var _a = incoming[0], action = _a.action, state = _a.state;\n        var storeResponses = incoming[1];\n        var actionName = action.type;\n        var matchingResponses = storeResponses\n            .filter(function (response) { return response.name === actionName; });\n        var newActions = matchingResponses.map(function (x) {\n            return {\n                type: x.targetName,\n                payload: state.getIn(x.path, index_1.getMap({})).toJS(),\n                via: \"[response to (\" + actionName + \")]\"\n            };\n        });\n        return Rx.Observable.from(newActions);\n    });\n}\nexports.handleResponses = handleResponses;\n//# sourceMappingURL=responses.js.map"]}
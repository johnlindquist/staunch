{"version":3,"sources":["node_modules/browser-pack/_prelude.js","dist/StaunchStore.js","dist/actions.js","dist/addEffects.js","dist/addReducers.js","dist/index.js","dist/responses.js","dist/subjects.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","Object","defineProperty","value","index_1","BehaviorSubject_1","window","global","Subject_1","subjects_1","addEffects_1","addReducers_1","StaunchStore","props","this","isOpen","state$","BehaviorSubject","state","subs","userExtra$","newExtras$","Subject","push","scan","assignFn","subscribe","storeReducers","newReducer$","concatFn","mappedReducers","newMappedReducer$","storeResponses","newResponses","action$","actionsWithState$","withLatestFrom","action","actionsWithResultingStateUpdate$","postDispatchFns","concat","postDispatch","filter","Boolean","prototype","register","input","reducers","effects","responses","extras","_registerOnStateTree","_addReducers","_addExtras","_addEffects","_addResponses","key","dispatcher","type","payload","path","_this","alwaysArray","forEach","extra","next","resp","keys","actionName","item","name","targetName","Array","isArray","fn","_addMiddleware","middleware","incoming","storeExtras","gatherEffects","outgoing","InputTypes","Effect","bind","gatherReducers","Reducer","MappedReducer","State","addReducers","dispatch","getState","lookup","getValue","getIn","getMap","toJS","toJSON","addMiddleware","changes","map","x","distinctUntilChanged","once","actions","indexOf","take","addExtras","addEffects","close","sub","unsubscribe","ofType","_a","actionStream","intialState","do","isPlainObject","console","error","mappedReducersThatMatchAction","reducer","stateMap","actionType","setIn","alwaysMap","reduce","outgoingValue","reducerPayload","ReducerTypes","updateIn","currentValue","fns","__assign","assign","arguments","p","hasOwnProperty","actionsApi","acc","effect","stream","triggers","trigger","effectOutput","via","initial","reducers_1","stateKey","maps","currentFn","Immutable","actions_1","responses_1","StaunchStore_1","createStore","mergedInitialState","store","handleResponses","Map","isMap","fromJS","objectTag","toString","default","staunch","Observable_1","_","flatMap","matchingResponses","response","newActions","Observable","of"],"mappings":"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","sourceRoot":"","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nvar BehaviorSubject_1 = (typeof window !== \"undefined\" ? window['Rx'] : typeof global !== \"undefined\" ? global['Rx'] : null);\nvar Subject_1 = (typeof window !== \"undefined\" ? window['Rx'] : typeof global !== \"undefined\" ? global['Rx'] : null);\nvar subjects_1 = require(\"./subjects\");\nvar addEffects_1 = require(\"./addEffects\");\nvar addReducers_1 = require(\"./addReducers\");\nvar StaunchStore = (function () {\n    function StaunchStore(props) {\n        this.isOpen = true;\n        this.state$ = new BehaviorSubject_1.BehaviorSubject(props.state);\n        this.subs = [];\n        this.userExtra$ = new BehaviorSubject_1.BehaviorSubject({});\n        this.newExtras$ = new Subject_1.Subject();\n        this.subs.push(this.newExtras$.scan(subjects_1.assignFn, {}).subscribe(this.userExtra$));\n        // reducers to act upon state\n        this.storeReducers = new BehaviorSubject_1.BehaviorSubject([]);\n        this.newReducer$ = new Subject_1.Subject();\n        this.subs.push(this.newReducer$.scan(subjects_1.concatFn, []).subscribe(this.storeReducers));\n        // Mapped reducers\n        this.mappedReducers = new BehaviorSubject_1.BehaviorSubject([]);\n        this.newMappedReducer$ = new Subject_1.Subject();\n        this.subs.push(this.newMappedReducer$.scan(subjects_1.concatFn, []).subscribe(this.mappedReducers));\n        // responses\n        this.storeResponses = new BehaviorSubject_1.BehaviorSubject([]);\n        this.newResponses = new Subject_1.Subject();\n        this.subs.push(this.newResponses.scan(subjects_1.concatFn, []).subscribe(this.storeResponses));\n        // stream of actions\n        this.action$ = new Subject_1.Subject();\n        this.actionsWithState$ = this.action$.withLatestFrom(this.state$, function (action, state) {\n            return {\n                action: action,\n                state: state\n            };\n        });\n        this.actionsWithResultingStateUpdate$ = this.actionsWithState$;\n        this.postDispatchFns = [].concat(props.postDispatch).filter(Boolean);\n    }\n    StaunchStore.prototype.register = function (input) {\n        var state = input.state, reducers = input.reducers, effects = input.effects, responses = input.responses, extras = input.extras;\n        if (state) {\n            this._registerOnStateTree(state);\n        }\n        if (reducers) {\n            this._addReducers(reducers);\n        }\n        if (extras) {\n            this._addExtras(extras);\n        }\n        if (effects) {\n            this._addEffects(effects);\n        }\n        if (responses) {\n            this._addResponses(responses);\n        }\n        return this;\n    };\n    StaunchStore.prototype._registerOnStateTree = function (state) {\n        for (var key in state) {\n            // now init with action\n            this.dispatcher({\n                type: '@@NS-INIT(' + key + ')',\n                payload: {\n                    path: [key],\n                    value: state[key]\n                }\n            });\n        }\n    };\n    StaunchStore.prototype._addExtras = function (extras) {\n        var _this = this;\n        index_1.alwaysArray(extras).forEach(function (extra) {\n            _this.newExtras$.next(extra);\n        });\n    };\n    StaunchStore.prototype._addResponses = function (responses) {\n        var _this = this;\n        index_1.alwaysArray(responses).forEach(function (resp) {\n            Object.keys(resp).forEach(function (actionName) {\n                var item = resp[actionName];\n                _this.newResponses.next({\n                    name: actionName,\n                    path: [].concat(item.path).filter(Boolean),\n                    targetName: item.action\n                });\n            });\n        });\n    };\n    /**\n     * Dispatch 1 or many actions\n     * @param action\n     * @returns {*}\n     * @private\n     */\n    StaunchStore.prototype.dispatcher = function (action) {\n        var _this = this;\n        if (!this.isOpen) {\n            return;\n        }\n        if (Array.isArray(action)) {\n            action.forEach(function (a) {\n                _this.action$.next(a);\n            });\n        }\n        else {\n            this.action$.next(action);\n        }\n        if (this.postDispatchFns.length) {\n            this.postDispatchFns.forEach(function (fn) { return fn(action); });\n        }\n    };\n    StaunchStore.prototype._addMiddleware = function (middleware) {\n        var _this = this;\n        index_1.alwaysArray(middleware).forEach(function (middleware) {\n            middleware.call(null, _this);\n        });\n    };\n    StaunchStore.prototype._addEffects = function (incoming) {\n        var _this = this;\n        /**\n         * Default extras that get passed to all 'effects'\n         */\n        var storeExtras = {\n            state$: this.state$,\n            action$: this.action$,\n            actionsWithState$: this.actionsWithState$,\n            actionsWithResultingStateUpdate$: this.actionsWithState$\n        };\n        addEffects_1.gatherEffects(incoming, this.actionsWithState$, storeExtras, this.userExtra$)\n            .forEach(function (outgoing) {\n            if (outgoing.type === addReducers_1.InputTypes.Effect) {\n                _this.subs.push(outgoing.payload.subscribe(_this.dispatcher.bind(_this)));\n            }\n        });\n    };\n    StaunchStore.prototype._addReducers = function (incoming) {\n        var _this = this;\n        addReducers_1.gatherReducers(incoming)\n            .forEach(function (outgoing) {\n            if (outgoing.type === addReducers_1.InputTypes.Reducer) {\n                _this.newReducer$.next(outgoing.payload);\n            }\n            if (outgoing.type === addReducers_1.InputTypes.MappedReducer) {\n                _this.newMappedReducer$.next(outgoing.payload);\n            }\n            if (outgoing.type === addReducers_1.InputTypes.State) {\n                _this._registerOnStateTree(outgoing.payload);\n            }\n        });\n    };\n    StaunchStore.prototype.addReducers = function (reducers) {\n        this._addReducers(reducers);\n        return this;\n    };\n    StaunchStore.prototype.dispatch = function (action) {\n        this.dispatcher(action);\n        return this;\n    };\n    StaunchStore.prototype.getState = function (path) {\n        var lookup = index_1.alwaysArray(path);\n        return this.state$.getValue().getIn(lookup, index_1.getMap({}));\n    };\n    StaunchStore.prototype.toJS = function (path) {\n        var lookup = index_1.alwaysArray(path);\n        return this.state$.getValue().getIn(lookup, index_1.getMap({})).toJS();\n    };\n    StaunchStore.prototype.toJSON = function (path) {\n        var lookup = index_1.alwaysArray(path);\n        return this.state$.getValue().getIn(lookup, index_1.getMap({})).toJSON();\n    };\n    StaunchStore.prototype.addMiddleware = function (middleware) {\n        this._addMiddleware(middleware);\n        return this;\n    };\n    StaunchStore.prototype.changes = function (path) {\n        var lookup = index_1.alwaysArray(path);\n        return this.state$.map(function (x) { return x.getIn(lookup); })\n            .distinctUntilChanged();\n    };\n    StaunchStore.prototype.once = function (actions) {\n        var lookup = index_1.alwaysArray(actions);\n        return this.actionsWithState$.filter(function (x) {\n            return lookup.indexOf(x.action.type) > -1;\n        }).take(1);\n    };\n    StaunchStore.prototype.addExtras = function (extras) {\n        this._addExtras(extras);\n        return this;\n    };\n    StaunchStore.prototype.addEffects = function (effects) {\n        this._addEffects(effects);\n        return this;\n    };\n    StaunchStore.prototype.close = function () {\n        if (this.isOpen) {\n            this.subs.forEach(function (sub) { return sub.unsubscribe(); });\n            this.isOpen = false;\n        }\n        return this;\n    };\n    StaunchStore.prototype.ofType = function (path) {\n        var lookup = index_1.alwaysArray(path);\n        return this.actionsWithState$\n            .filter(function (_a) {\n            var action = _a.action;\n            return lookup.indexOf(action.type) > -1;\n        });\n    };\n    return StaunchStore;\n}());\nexports.StaunchStore = StaunchStore;\n//# sourceMappingURL=StaunchStore.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nfunction actionStream(intialState, action$, storeReducers, mappedReducers) {\n    return action$\n        .do(function (action) {\n        if (!index_1.isPlainObject(action)) {\n            return console.error('Please provide an object with at least a `type` property');\n        }\n        if ((typeof action.type) !== 'string') {\n            return console.error('Action was missing a `type` property', action);\n        }\n    })\n        .withLatestFrom(storeReducers, mappedReducers, function (action, reducers, mappedReducers) {\n        var mappedReducersThatMatchAction = mappedReducers\n            .filter(function (reducer) {\n            return reducer.name === action.type;\n        });\n        return {\n            action: action,\n            reducers: mappedReducersThatMatchAction.concat(reducers),\n        };\n    })\n        .scan(function (stateMap, _a) {\n        var action = _a.action, reducers = _a.reducers;\n        var actionType = action.type || (typeof action === 'string' ? action : '');\n        // is it a @@namespace ?\n        if (actionType.indexOf('@@NS-INIT') === 0) {\n            return stateMap.setIn(action.payload.path, index_1.alwaysMap((action.payload || {}).value));\n        }\n        else {\n            /**\n             * Iterate through all valid reducers\n             * This will include those registered via simple functions\n             * + those mapped to a path with a specific Action name\n             */\n            return reducers.reduce(function (outgoingValue, reducer) {\n                /**\n                 * Decide whether to pass {type: NAME, payload: VALUE}\n                 *                   or   VALUE only into the reducer\n                 *\n                 */\n                var reducerPayload = reducer.type === index_1.ReducerTypes.MappedReducer\n                    ? action.payload\n                    : action;\n                /**\n                 * Now use updateIn to call this reducers functions (there could be many)\n                 * on the value that lives at this point of the tree\n                 */\n                return outgoingValue.updateIn(reducer.path, function (currentValue) {\n                    return reducer.fns.reduce(function (value, fn) {\n                        return fn.call(null, value, reducerPayload, outgoingValue);\n                    }, currentValue);\n                });\n            }, stateMap);\n        }\n    }, intialState);\n}\nexports.actionStream = actionStream;\n//# sourceMappingURL=actions.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nvar addReducers_1 = require(\"./addReducers\");\nfunction gatherEffects(incoming, actionsWithState$, storeExtras, userExtra$) {\n    var actionsApi = {\n        ofType: function (actionName) {\n            return actionsWithState$.filter(function (incoming) {\n                return incoming.action.type === actionName;\n            });\n        }\n    };\n    var extras = Object.assign({}, storeExtras, userExtra$.getValue());\n    return index_1.alwaysArray(incoming).reduce(function (acc, effect) {\n        if (typeof effect !== 'function') {\n            console.error('Effects must be functions, you provided', effect);\n        }\n        var stream = (function () {\n            if (effect.triggers && Array.isArray(effect.triggers)) {\n                return actionsWithState$.filter(function (incoming) {\n                    return ~effect.triggers.indexOf(incoming.action.type);\n                });\n            }\n            if (effect.trigger && typeof effect.trigger === 'string') {\n                return actionsWithState$.filter(function (incoming) {\n                    return effect.trigger === incoming.action.type;\n                });\n            }\n            return actionsApi;\n        })();\n        // todo, verify the output of this ie: ensure an observable\n        // was returned\n        var effectOutput = effect.call(null, stream, extras);\n        return acc.concat({\n            type: addReducers_1.InputTypes.Effect,\n            payload: effectOutput.map(function (action) {\n                return __assign({}, action, { via: '[effect]', name: (effect.name || '') });\n            })\n        });\n    }, []);\n}\nexports.gatherEffects = gatherEffects;\n//# sourceMappingURL=addEffects.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\n/**\n * Add either plain functions or {path, fns} pairs\n * @param reducers\n * outputTypes:\n *  - reducer\n *  - mappedReducer\n *  - effect\n *  - state\n * @private\n */\nvar InputTypes;\n(function (InputTypes) {\n    InputTypes[InputTypes[\"Reducer\"] = 'Reducer'] = \"Reducer\";\n    InputTypes[InputTypes[\"MappedReducer\"] = 'MappedReducers'] = \"MappedReducer\";\n    InputTypes[InputTypes[\"Effect\"] = 'Effect'] = \"Effect\";\n    InputTypes[InputTypes[\"State\"] = 'State'] = \"State\";\n})(InputTypes = exports.InputTypes || (exports.InputTypes = {}));\nfunction gatherReducers(incoming) {\n    return _addReducers(incoming, []);\n    function _addReducers(reducers, initial) {\n        return index_1.alwaysArray(reducers).reduce(function (acc, reducer) {\n            if (typeof reducer === 'function') {\n                return acc.concat({\n                    type: InputTypes.Reducer,\n                    payload: {\n                        path: [],\n                        fns: [reducer]\n                    }\n                });\n            }\n            if (index_1.isPlainObject(reducer)) {\n                if (reducer.state) {\n                    var reducers_1, state = void 0, effects = void 0;\n                    if (reducer.reducers) {\n                        /**\n                         * if 'state' and 'reducers' key were found,\n                         * we bind the reducers to that top-level state key\n                         */\n                        reducers_1 = Object.keys(reducer.state).reduce(function (acc, stateKey) {\n                            return acc.concat(_addReducers({ path: stateKey, fns: reducer.reducers }, []));\n                        }, []);\n                    }\n                    if (reducer.effects) {\n                        effects = reducer.effects;\n                    }\n                    /**\n                     *\n                     */\n                    state = reducer.state;\n                    return acc.concat(reducers_1, {\n                        type: InputTypes.Effect,\n                        payload: effects\n                    }, {\n                        type: InputTypes.State,\n                        payload: state\n                    });\n                }\n                if (reducer.path && reducer.reducers) {\n                    var maps = Object.keys(reducer.reducers).reduce(function (acc, name) {\n                        var currentFn = reducer.reducers[name];\n                        return acc.concat({\n                            type: InputTypes.MappedReducer,\n                            payload: {\n                                path: [].concat(reducer.path),\n                                fns: [currentFn],\n                                name: name,\n                                type: index_1.ReducerTypes.MappedReducer\n                            }\n                        });\n                    }, []);\n                    return acc.concat(maps);\n                }\n                /**\n                 * if path/fn pairs given\n                 */\n                if (reducer.path && reducer.fns) {\n                    return acc.concat({\n                        type: InputTypes.Reducer,\n                        payload: {\n                            path: [].concat(reducer.path).filter(Boolean),\n                            fns: [].concat(reducer.fns).filter(Boolean)\n                        }\n                    }, initial);\n                }\n                else {\n                    // redux style key: fn pairs\n                    var outgoing = Object.keys(reducer).reduce(function (acc, key) {\n                        return acc.concat({\n                            type: InputTypes.Reducer,\n                            payload: {\n                                path: [].concat(key).filter(Boolean),\n                                fns: [].concat(reducer[key]).filter(Boolean)\n                            }\n                        });\n                    }, []);\n                    return acc.concat(outgoing);\n                }\n            }\n            return acc;\n        }, initial);\n    }\n}\nexports.gatherReducers = gatherReducers;\n//# sourceMappingURL=addReducers.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Immutable = (typeof window !== \"undefined\" ? window['Immutable'] : typeof global !== \"undefined\" ? global['Immutable'] : null);\nvar actions_1 = require(\"./actions\");\nvar responses_1 = require(\"./responses\");\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nrequire('./../noop.js');\nvar StaunchStore_1 = require(\"./StaunchStore\");\nexports.StaunchStore = StaunchStore_1.StaunchStore;\nvar ReducerTypes;\n(function (ReducerTypes) {\n    ReducerTypes[ReducerTypes[\"MappedReducer\"] = 'MappedReducer'] = \"MappedReducer\";\n    ReducerTypes[ReducerTypes[\"GlobalReducer\"] = 'GlobalReducer'] = \"GlobalReducer\";\n})(ReducerTypes = exports.ReducerTypes || (exports.ReducerTypes = {}));\nfunction createStore(props) {\n    if (props === void 0) { props = {}; }\n    var mergedInitialState = alwaysMap(props.state);\n    var store = new StaunchStore_1.StaunchStore(__assign({}, props, { state: mergedInitialState }));\n    var subs = [];\n    // stream\n    subs.push(actions_1.actionStream(mergedInitialState, store.action$, store.storeReducers, store.mappedReducers)\n        .subscribe(store.state$));\n    /**\n     * Setup responses for declarative cross-domain communication\n     */\n    subs.push(responses_1.handleResponses(store.actionsWithState$, store.storeResponses)\n        .subscribe(function (action) { return store.dispatcher(action); }));\n    store.addReducers(props.reducers);\n    store.addEffects(props.effects);\n    store.addMiddleware(props.middleware);\n    store.addExtras(props.extras);\n    return store;\n}\nexports.createStore = createStore;\nfunction alwaysArray(input) {\n    return [].concat(input).filter(Boolean);\n}\nexports.alwaysArray = alwaysArray;\nfunction getMap(incoming) {\n    return Immutable.Map(incoming);\n}\nexports.getMap = getMap;\nfunction alwaysMap(input) {\n    return Immutable.Map.isMap(input) ? input : Immutable.fromJS(input || {});\n}\nexports.alwaysMap = alwaysMap;\nfunction isPlainObject(value) {\n    var objectTag = '[object Object]';\n    return Object.prototype.toString.call(value) === objectTag;\n}\nexports.isPlainObject = isPlainObject;\nexports.default = createStore;\nif ((typeof window !== 'undefined') && ((typeof window.staunch) === 'undefined')) {\n    window.staunch = {\n        createStore: createStore\n    };\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Observable_1 = (typeof window !== \"undefined\" ? window['Rx'] : typeof global !== \"undefined\" ? global['Rx'] : null);\nvar index_1 = require(\"./index\");\nfunction handleResponses(actionsWithState$, storeResponses) {\n    /**\n     * Setup responses for declarative cross-domain communication\n     */\n    return actionsWithState$\n        .withLatestFrom(storeResponses)\n        .filter(function (_a) {\n        var _ = _a[0], storeResponses = _a[1];\n        return storeResponses.length > 0;\n    })\n        .flatMap(function (incoming) {\n        var _a = incoming[0], action = _a.action, state = _a.state;\n        var storeResponses = incoming[1];\n        var actionName = action.type;\n        var matchingResponses = storeResponses\n            .filter(function (response) { return response.name === actionName; });\n        var newActions = matchingResponses.map(function (x) {\n            return {\n                type: x.targetName,\n                payload: state.getIn(x.path, index_1.getMap({})).toJS(),\n                via: \"[response to (\" + actionName + \")]\"\n            };\n        });\n        return Observable_1.Observable.of(newActions);\n    });\n}\nexports.handleResponses = handleResponses;\n//# sourceMappingURL=responses.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction assignFn(extras, incoming) {\n    return Object.assign({}, extras, incoming);\n}\nexports.assignFn = assignFn;\nfunction concatFn(acc, incoming) {\n    return acc.concat(incoming);\n}\nexports.concatFn = concatFn;\n//# sourceMappingURL=subjects.js.map"]}